ggplot(df_upperLower_1, aes(x = midpoint, y = mean, ymin = lower, ymax = upper)) +
geom_line( color = "#558C8C")
ggplot(df_upperLower_1, aes(x = midpoint, y = mean, ymin = lower, ymax = upper)) +
geom_line( color = "#558C8C")+
geom_point(data = datS1, color = "#558C8C")
View(datS1)
df_chik[,c("midpoint","lo","hi")] = binom.confint(df_chik$N.pos, df_chik$N, method="exact")[,c("mean","lower","upper")]
df_chik <-  df_chik %>%
dplyr::mutate(agemid = (age_min+age_max)/2)
#sub-setting datafiles by study
datS1 <- df_chik[df_chik$study == "1",]
datS2 <- df_chik[df_chik$study == "2",]
datS3 <- df_chik[df_chik$study == "3",]
datS1
df_chik[,c("midpoint","lo","hi")] = binom.confint(df_chik$N.pos, df_chik$N, method="exact")[,c("mean","lower","upper")]
View(df_chik)
ggplot(df_upperLower_1, aes(x = midpoint, y = mean, ymin = lower, ymax = upper)) +
geom_line( color = "#558C8C")+
geom_point(data = datS1, color = "#558C8C")+
geom_linerange(data = datS1, color = "#558C8C") +
geom_line(data = df_upperLower_2, aes(x = midpoint, y = mean),color = "#C05746") +
geom_ribbon(data = df_upperLower_2, fill = "#C05746")+
geom_point(data = datS2,color = "#C05746")+
geom_linerange(data = datS2,color = "#C05746") +
xlab("Age (years)") + ylab("Proportion Seropositive") +
scale_x_continuous(breaks = seq(0, 100, by = 10)) +
ylim(0, 1) +
theme_bw()
df_chik[,c("midpoint","lower","upper")] = binom.confint(df_chik$N.pos, df_chik$N, method="exact")[,c("mean","lower","upper")]
df_chik <-  df_chik %>%
dplyr::mutate(agemid = (age_min+age_max)/2)
#sub-setting datafiles by study
datS1 <- df_chik[df_chik$study == "1",]
datS2 <- df_chik[df_chik$study == "2",]
datS3 <- df_chik[df_chik$study == "3",]
ggplot(df_upperLower_1, aes(x = midpoint, y = mean, ymin = lower, ymax = upper)) +
geom_line( color = "#558C8C")+
geom_point(data = datS1, color = "#558C8C")+
geom_linerange(data = datS1, color = "#558C8C") +
geom_line(data = df_upperLower_2, aes(x = midpoint, y = mean),color = "#C05746") +
geom_ribbon(data = df_upperLower_2, fill = "#C05746")+
geom_point(data = datS2,color = "#C05746")+
geom_linerange(data = datS2,color = "#C05746") +
xlab("Age (years)") + ylab("Proportion Seropositive") +
scale_x_continuous(breaks = seq(0, 100, by = 10)) +
ylim(0, 1) +
theme_bw()
ggplot(df_upperLower_1, aes(x = midpoint, y = mean, ymin = lower, ymax = upper)) +
geom_line( color = "#558C8C")+
geom_point(data = datS1, color = "#558C8C")+
geom_linerange(data = datS1, color = "#558C8C")
ggplot(df_upperLower_1, aes(x = midpoint, y = mean, ymin = lower, ymax = upper)) +
geom_line( color = "#558C8C")+
geom_point(data = datS1, color = "#558C8C")
rlang::last_error()
View(datS1)
ggplot(df_upperLower_1, aes(x = midpoint, y = mean, ymin = lower, ymax = upper)) +
geom_line( color = "#558C8C")+
geom_point(data = datS1, color = "#558C8C")+
geom_linerange(data = datS1, color = "#558C8C")
geom_point(data = datS2,color = "#C05746")
geom_ribbon(data = df_upperLower_2, fill = "#C05746")
ggplot(df_upperLower_1, aes(x=midpoint, y=mean, ymin=lower, ymax=upper)) +
geom_ribbon(alpha=0.2)+
geom_line()+
geom_point(data=datS1)+
geom_linerange(data=datS1) +
xlab("Age (years)") + ylab("seropositivity") +
scale_x_continuous(breaks=seq(0,100,by=5))
ggplot(df_upperLower_1, aes(x=midpoint, y=mean, ymin=lower, ymax=upper)) +
geom_ribbon(alpha=0.2)+
geom_line()
geom_point(data=datS1)
View(datS1)
Dengue_sero_data <- read_excel("C:/Users/Hyolim/OneDrive - London School of Hygiene and Tropical Medicine/CHIK/code/Dengue_sero_data.xlsx")
View(Dengue_sero_data)
df_IgG = Dengue_sero_data %>% subset(measure == "IgG+IgM")
df_IgG$agemid=c(2.5, 10, 20, 30, 45)
df_IgG[,c("mid","lo","hi")] = binom.confint(df_IgG$n.pos, df_IgG$N,method="exact")[,c("mean","lower","upper")]
View(df_IgG)
df_mod
#define model
jcode <- "model{
for (i in 1:length(N)){
n.pos[i] ~ dbinom(seropos_est[i],N[i]) #fit to binomial data
seropos_est[i] = 1-exp(-lambda*age[i]) #catalytic model
}
lambda ~ dunif(0,1) #uninformative prior
}"
# Run model
mcmc.length=10000
jdat = list(n.pos= df_IgG$n.pos,
N=df_IgG$N,
age=df_IgG$agemid)
jmod = jags.model(textConnection(jcode), data=jdat, n.chains=1, n.adapt=1000)
update(jmod)
jpos = coda.samples(jmod, c("lambda"), n.iter=mcmc.length)
plot(jpos[[1]]) # check convergence
summary(jpos)
# Get posteriors
lambda_est = jpos[[1]] %>% quantile(probs=c(.5,.025,.975))
ager=0:55
df_mod=data.frame(agemid=ager,
mid=1-exp(-lambda_est[1]*ager),
lo=1-exp(-lambda_est[2]*ager),
hi=1-exp(-lambda_est[3]*ager))
# plot
ggplot(df_mod, aes(x=agemid, y=mid, ymin=lo, ymax=hi)) +
geom_ribbon(alpha=0.2)+
geom_line()+
geom_point(data=df_IgG)+
geom_linerange(data=df_IgG) +
xlab("Age (years)") + ylab("seropositivity") +
scale_x_continuous(breaks=seq(0,100,by=5))
lambda_est %>% round(3) %>% print
View(df_mod)
ggplot(df_upperLower_1, aes(x=midpoint, y=mean, ymin=lower, ymax=upper)) +
geom_ribbon(alpha=0.2)+
geom_line()+
geom_point(data=datS1, x = agemid)+
geom_linerange(data=datS1) +
xlab("Age (years)") + ylab("seropositivity") +
scale_x_continuous(breaks=seq(0,100,by=5))
ggplot(df_upperLower_1, aes(x=midpoint, y=mean, ymin=lower, ymax=upper)) +
geom_ribbon(alpha=0.2)
ggplot(df_upperLower_1, aes(x=midpoint, y=mean, ymin=lower, ymax=upper)) +
geom_ribbon(alpha=0.2)+
geom_line()
ggplot(df_upperLower_2, aes(x=midpoint, y=mean, ymin=lower, ymax=upper)) +
geom_ribbon(alpha=0.2)+
geom_line()
ggplot(df_upperLower_3, aes(x=midpoint, y=mean, ymin=lower, ymax=upper)) +
geom_ribbon(alpha=0.2)+
geom_line()
ggplot(df_upperLower_2, aes(x=midpoint, y=mean, ymin=lower, ymax=upper)) +
geom_ribbon(alpha=0.2)+
geom_line()
ggplot(df_upperLower_3, aes(x=midpoint, y=mean, ymin=lower, ymax=upper)) +
geom_ribbon(alpha=0.2)+
geom_line()
ggplot(df_upperLower_2, aes(x=midpoint, y=mean, ymin=lower, ymax=upper)) +
geom_ribbon(alpha=0.2)+
geom_line()
ggplot(df_upperLower_2, aes(x=midpoint, y=mean, ymin=lower, ymax=upper)) +
geom_ribbon(alpha=0.2)+
geom_line()+
scale_x_continuous(breaks=seq(0,100,by=5))
ggplot(df_upperLower_2, aes(x=midpoint, y=mean, ymin=lower, ymax=upper)) +
geom_ribbon(alpha=0.2)+
geom_line()+
scale_x_continuous(breaks=seq(0,100,by=5))+
xlab("Age (years)") + ylab("seropositivity")
ggplot(df_upperLower_2, aes(x=midpoint, y=mean, ymin=lower, ymax=upper)) +
geom_ribbon(alpha=0.2)+
geom_line()+
scale_x_continuous(breaks=seq(0,100,by=5))+
xlab("Age (years)") + ylab("Seropositivity")
ggplot(df_upperLower_3, aes(x=midpoint, y=mean, ymin=lower, ymax=upper)) +
geom_ribbon(alpha=0.2)+
geom_line()+
scale_x_continuous(breaks=seq(0,100,by=5)) +
xlab("Age (years)") + ylab("Seropositivity")
View(datS3)
View(datS2)
ggplot(df_upperLower_2, aes(x=midpoint, y=mean, ymin=lower, ymax=upper)) +
geom_ribbon(alpha=0.2)+
geom_line()+
scale_x_continuous(breaks=seq(0,100,by=5))+
xlab("Age (years)") + ylab("Seropositivity") +
geom_point(data=datS1)+
geom_linerange(data=datS1)
geom_line(data = df_upperLower_2, aes(x=midpoint, y=mean, ymin=lower, ymax=upper))
ggplot()+
geom_line(data = df_upperLower_2, aes(x=midpoint, y=mean, ymin=lower, ymax=upper))+
geom_ribbon(alpha=0.2)+
geom_line()
ggplot()+
geom_line(data = df_upperLower_2, aes(x=midpoint, y=mean))+
geom_ribbon(alpha=0.2,ymin=lower, ymax=upper)+
geom_line()
ggplot()+
geom_line(data = df_upperLower_2, aes(x=midpoint, y=mean))+
geom_ribbon(data = df_upperLower_2, alpha=0.2,ymin=lower, ymax=upper)+
geom_line()
ggplot()+
geom_line(data = df_upperLower_2, aes(x=midpoint, y=mean))+
geom_ribbon(data = df_upperLower_2, alpha=0.2, ymin=lower, ymax=upper)
ggplot()+
geom_line(data = df_upperLower_2, aes(x=midpoint, y=mean))+
geom_ribbon(data = df_upperLower_2, alpha=0.2, x= midpoint, ymin=lower, ymax=upper)
ggplot()+
geom_line(data = df_upperLower_2, aes(x=midpoint, y=mean))+
geom_ribbon(data = df_upperLower_2, alpha=0.2, aes(ymin=lower, ymax=upper))
ggplot()+
geom_line(data = df_upperLower_2, aes(x=midpoint, y=mean))+
geom_ribbon(data = df_upperLower_2, alpha=0.2, aes(x=midpoint, y=mean, ymin=lower, ymax=upper))
ggplot()+
geom_line(data = df_upperLower_2, aes(x=midpoint, y=mean))+
geom_ribbon(data = df_upperLower_2, alpha=0.2, aes(x=midpoint, y=mean, ymin=lower, ymax=upper))+
geom_pont(data = datS1)
ggplot()+
geom_line(data = df_upperLower_2, aes(x=midpoint, y=mean))+
geom_ribbon(data = df_upperLower_2, alpha=0.2, aes(x=midpoint, y=mean, ymin=lower, ymax=upper))+
geom_point(data = datS1)
ggplot()+
geom_line(data = df_upperLower_2, aes(x=midpoint, y=mean))+
geom_ribbon(data = df_upperLower_2, alpha=0.2, aes(x=midpoint, y=mean, ymin=lower, ymax=upper))+
geom_point(data = datS1, aes(x=agemid, y=mid, ymin=lo, ymax=hi))
ggplot()+
geom_line(data = df_upperLower_2, aes(x=midpoint, y=mean))+
geom_ribbon(data = df_upperLower_2, alpha=0.2, aes(x=midpoint, y=mean, ymin=lower, ymax=upper))+
geom_point(data = datS1, aes(x=agemid, y=mid, ymin=lo, ymax=hi))+
geom_linerange(data=datS1)
ggplot()+
geom_line(data = df_upperLower_2, aes(x=midpoint, y=mean))+
geom_ribbon(data = df_upperLower_2, alpha=0.2, aes(x=midpoint, y=mean, ymin=lower, ymax=upper))+
geom_point(data = datS1, aes(x=agemid, y=mid))+
geom_linerange(data=datS1)
ggplot()+
geom_line(data = df_upperLower_2, aes(x=midpoint, y=mean))+
geom_ribbon(data = df_upperLower_2, alpha=0.2, aes(x=midpoint, y=mean, ymin=lower, ymax=upper))+
geom_point(data = datS1, aes(x=agemid, y=midpoint))+
geom_linerange(data=datS1)
ggplot()+
geom_line(data = df_upperLower_2, aes(x=midpoint, y=mean))+
geom_ribbon(data = df_upperLower_2, alpha=0.2, aes(x=midpoint, y=mean, ymin=lower, ymax=upper))+
geom_point(data = datS1, aes(x=agemid, y=midpoint))+
geom_linerange(data=datS1, ymin=lo, ymax=hi)
ggplot()+
geom_line(data = df_upperLower_2, aes(x=midpoint, y=mean))+
geom_ribbon(data = df_upperLower_2, alpha=0.2, aes(x=midpoint, y=mean, ymin=lower, ymax=upper))+
geom_point(data = datS1, aes(x=agemid, y=midpoint))+
geom_linerange(data=datS1, aes(ymin=lo, ymax=hi))
ggplot()+
geom_line(data = df_upperLower_2, aes(x=midpoint, y=mean))+
geom_ribbon(data = df_upperLower_2, alpha=0.2, aes(x=midpoint, y=mean, ymin=lower, ymax=upper))+
geom_point(data = datS1, aes(x=agemid, y=midpoint))+
geom_linerange(data=datS1, aes(xmin=lo, xmax=hi))
ggplot()+
geom_line(data = df_upperLower_2, aes(x=midpoint, y=mean))+
geom_ribbon(data = df_upperLower_2, alpha=0.2, aes(x=midpoint, y=mean, ymin=lower, ymax=upper))+
geom_point(data = datS1, aes(x=agemid, y=midpoint))+
geom_linerange(data=datS1, aes(xmin=age_min , xmax=age_max ,ymin=lo, ymax=hi))
ggplot()+
geom_line(data = df_upperLower_2, aes(x=midpoint, y=mean))+
geom_ribbon(data = df_upperLower_2, alpha=0.2, aes(x=midpoint, y=mean, ymin=lower, ymax=upper))+
geom_point(data = datS1, aes(x=agemid, y=midpoint))
View(datS2)
ggplot()+
geom_line(data = df_upperLower_2, aes(x=midpoint, y=mean))+
geom_ribbon(data = df_upperLower_2, alpha=0.2, aes(x=midpoint, y=mean, ymin=lower, ymax=upper))+
geom_point(data = datS2, aes(x=agemid, y=midpoint))
View(df_mod)
View(df_IgG)
View(df_upperLower_2)
library(readxl)
chik_systematic_review_v1 <- read_excel("C:/Users/Hyolim/OneDrive - London School of Hygiene and Tropical Medicine/CHIK/1.Aim1/all_countries/chik_systematic_review_v1.xlsx",
sheet = "prac")
View(chik_systematic_review_v1)
#Rename data
df_chik = chik_systematic_review_v1
df_chik[,c("midpoint","lower","upper")] = binom.confint(df_chik$N.pos, df_chik$N, method="exact")[,c("mean","lower","upper")]
df_chik <-  df_chik %>%
dplyr::mutate(agemid = (age_min+age_max)/2)
#sub-setting datafiles by study
datS1 <- df_chik[df_chik$study == "1",]
datS2 <- df_chik[df_chik$study == "2",]
datS3 <- df_chik[df_chik$study == "3",]
View(datS2)
View(df_upperLower_1)
df_upperLower_1 = data.frame(
agemid = ager1,
mean = meanLambda1,
upper = quantileMatrix_1[,3],
lower = quantileMatrix_1[,2]
)
ggplot(df_upperLower_2, aes(x=agemid, y=mid, ymin=lower, ymax=upper)) +
geom_ribbon(alpha=0.2)+
geom_line()+
geom_point(data=datS1)+
geom_linerange(data=datS1) +
xlab("Age (years)") + ylab("seropositivity") +
scale_x_continuous(breaks=seq(0,100,by=5))
ggplot(df_upperLower_2, aes(x=agemid, y=mean, ymin=lower, ymax=upper)) +
geom_ribbon(alpha=0.2)+
geom_line()+
geom_point(data=datS1)+
geom_linerange(data=datS1) +
xlab("Age (years)") + ylab("seropositivity") +
scale_x_continuous(breaks=seq(0,100,by=5))
ggplot(df_upperLower_2, aes(x=agemid, y=mean, ymin=lower, ymax=upper)) +
geom_ribbon(alpha=0.2)+
geom_line()+
geom_point(data=datS2)+
geom_linerange(data=datS2) +
xlab("Age (years)") + ylab("seropositivity") +
scale_x_continuous(breaks=seq(0,100,by=5))
View(df_upperLower_2)
df_upperLower_2 = data.frame(
agemid = ager2,
mean = meanLambda2,
upper = quantileMatrix_2[,3],
lower = quantileMatrix_2[,2])
View(df_upperLower_2)
ggplot(df_upperLower_2, aes(x=agemid, y=mean, ymin=lower, ymax=upper)) +
geom_ribbon(alpha=0.2)+
geom_line()+
geom_point(data=datS2)+
geom_linerange(data=datS2) +
xlab("Age (years)") + ylab("seropositivity") +
scale_x_continuous(breaks=seq(0,100,by=5))
ggplot()+
geom_line(data = df_upperLower_2, aes(x=midpoint, y=mean))+
geom_ribbon(data = df_upperLower_2, alpha=0.2, aes(x=midpoint, y=mean, ymin=lower, ymax=upper))+
geom_point(data = datS2, aes(x=agemid, y=midpoint))+
geom_linerange(data = datS2, aes(x=agemid, ymin=lower, ymax=upper))
ggplot()+
geom_line(data = df_upperLower_2, aes(x=agemid, y=mean))+
geom_ribbon(data = df_upperLower_2, alpha=0.2, aes(x=agemid, y=mean, ymin=lower, ymax=upper))+
geom_point(data = datS2, aes(x=agemid, y=midpoint))+
geom_linerange(data = datS2, aes(x=agemid, ymin=lower, ymax=upper))
ggplot()+
geom_line(data = df_upperLower_2, aes(x=agemid, y=mean))+
geom_ribbon(data = df_upperLower_2, alpha=0.2, aes(x=agemid, y=mean, ymin=lower, ymax=upper))+
geom_point(data = datS2, aes(x=agemid, y=midpoint))+
geom_linerange(data = datS2, aes(x=agemid, ymin=lower, ymax=upper))+
theme_bw()
ggplot()+
geom_line(data = df_upperLower_2, aes(x=agemid, y=mean))+
geom_ribbon(data = df_upperLower_2, alpha=0.2, aes(x=agemid, y=mean, ymin=lower, ymax=upper))+
geom_point(data = datS2, aes(x=agemid, y=midpoint))+
geom_linerange(data = datS2, aes(x=agemid, ymin=lower, ymax=upper))+
theme_bw()+
geom_line(data = df_upperLower_1, aes(x=agemid, y=mean))+
geom_ribbon(data = df_upperLower_1, alpha=0.2, aes(x=agemid, y=mean, ymin=lower, ymax=upper))+
geom_point(data = datS1, aes(x=agemid, y=midpoint))+
geom_linerange(data = datS1, aes(x=agemid, ymin=lower, ymax=upper))
ggplot()+
geom_line(data = df_upperLower_2, aes(x=agemid, y=mean), color = "#558C8C")+
geom_ribbon(data = df_upperLower_2, alpha=0.2, aes(x=agemid, y=mean, ymin=lower, ymax=upper))+
geom_point(data = datS2, aes(x=agemid, y=midpoint))+
geom_linerange(data = datS2, aes(x=agemid, ymin=lower, ymax=upper))+
theme_bw()+
geom_line(data = df_upperLower_1, aes(x=agemid, y=mean))+
geom_ribbon(data = df_upperLower_1, alpha=0.2, aes(x=agemid, y=mean, ymin=lower, ymax=upper))+
geom_point(data = datS1, aes(x=agemid, y=midpoint))+
geom_linerange(data = datS1, aes(x=agemid, ymin=lower, ymax=upper))
ggplot()+
geom_line(data = df_upperLower_2, aes(x=agemid, y=mean), color = "#558C8C")+
geom_ribbon(data = df_upperLower_2, alpha=0.2, aes(x=agemid, y=mean, ymin=lower, ymax=upper))+
geom_point(data = datS2, aes(x=agemid, y=midpoint))+
geom_linerange(data = datS2, aes(x=agemid, ymin=lower, ymax=upper), color = "#558C8C")+
theme_bw()+
geom_line(data = df_upperLower_1, aes(x=agemid, y=mean))+
geom_ribbon(data = df_upperLower_1, alpha=0.2, aes(x=agemid, y=mean, ymin=lower, ymax=upper))+
geom_point(data = datS1, aes(x=agemid, y=midpoint))+
geom_linerange(data = datS1, aes(x=agemid, ymin=lower, ymax=upper))
ggplot()+
geom_line(data = df_upperLower_2, aes(x=agemid, y=mean), color = "#558C8C")+
geom_ribbon(data = df_upperLower_2, alpha=0.2, aes(x=agemid, y=mean, ymin=lower, ymax=upper))+
geom_point(data = datS2, aes(x=agemid, y=midpoint), color = "#558C8C")+
geom_linerange(data = datS2, aes(x=agemid, ymin=lower, ymax=upper), color = "#558C8C")+
theme_bw()+
geom_line(data = df_upperLower_1, aes(x=agemid, y=mean))+
geom_ribbon(data = df_upperLower_1, alpha=0.2, aes(x=agemid, y=mean, ymin=lower, ymax=upper))+
geom_point(data = datS1, aes(x=agemid, y=midpoint))+
geom_linerange(data = datS1, aes(x=agemid, ymin=lower, ymax=upper))
ggplot()+
geom_line(data = df_upperLower_2, aes(x=agemid, y=mean), color = "#558C8C")+
geom_ribbon(data = df_upperLower_2, alpha=0.2, aes(x=agemid, y=mean, ymin=lower, ymax=upper), fill = "#558C8C")+
geom_point(data = datS2, aes(x=agemid, y=midpoint), color = "#558C8C")+
geom_linerange(data = datS2, aes(x=agemid, ymin=lower, ymax=upper), color = "#558C8C")+
theme_bw()+
geom_line(data = df_upperLower_1, aes(x=agemid, y=mean))+
geom_ribbon(data = df_upperLower_1, alpha=0.2, aes(x=agemid, y=mean, ymin=lower, ymax=upper))+
geom_point(data = datS1, aes(x=agemid, y=midpoint))+
geom_linerange(data = datS1, aes(x=agemid, ymin=lower, ymax=upper))
ggplot()+
geom_line(data = df_upperLower_2, aes(x=agemid, y=mean), color = "#558C8C")+
geom_ribbon(data = df_upperLower_2, alpha=0.2, aes(x=agemid, y=mean, ymin=lower, ymax=upper), fill = "#558C8C")+
geom_point(data = datS2, aes(x=agemid, y=midpoint), color = "#558C8C")+
geom_linerange(data = datS2, aes(x=agemid, ymin=lower, ymax=upper), color = "#558C8C")+
theme_bw()+
geom_line(data = df_upperLower_1, aes(x=agemid, y=mean),color = "#C05746")+
geom_ribbon(data = df_upperLower_1, alpha=0.2, aes(x=agemid, y=mean, ymin=lower, ymax=upper),fill = "#C05746")+
geom_point(data = datS1, aes(x=agemid, y=midpoint),color = "#C05746")+
geom_linerange(data = datS1, aes(x=agemid, ymin=lower, ymax=upper),color = "#C05746")
ggplot()+
geom_line(data = df_upperLower_2, aes(x=agemid, y=mean), color = "#558C8C")+
geom_ribbon(data = df_upperLower_2, alpha=0.2, aes(x=agemid, y=mean, ymin=lower, ymax=upper), fill = "#558C8C")+
geom_point(data = datS2, aes(x=agemid, y=midpoint), color = "#558C8C")+
geom_linerange(data = datS2, aes(x=agemid, ymin=lower, ymax=upper), color = "#558C8C")+
theme_bw()+
geom_line(data = df_upperLower_1, aes(x=agemid, y=mean),color = "#C05746")+
geom_ribbon(data = df_upperLower_1, alpha=0.2, aes(x=agemid, y=mean, ymin=lower, ymax=upper),fill = "#C05746")+
geom_point(data = datS1, aes(x=agemid, y=midpoint),color = "#C05746")+
geom_linerange(data = datS1, aes(x=agemid, ymin=lower, ymax=upper),color = "#C05746")
geom_line(data = df_upperLower_3, aes(x=agemid, y=mean),color = "#075E9D")+
geom_ribbon(data = df_upperLower_3, alpha=0.2, aes(x=agemid, y=mean, ymin=lower, ymax=upper),fill = "#075E9D")+
geom_point(data = datS3, aes(x=agemid, y=midpoint),color = "#075E9D")+
geom_linerange(data = datS3, aes(x=agemid, ymin=lower, ymax=upper),color = "#075E9D")
View(datS3)
View(df_upperLower_3)
df_upperLower_3 = data.frame(
agemid = ager3,
mean = meanLambda3,
upper = quantileMatrix_3[,3],
lower = quantileMatrix_3[,2])
ggplot()+
geom_line(data = df_upperLower_2, aes(x=agemid, y=mean), color = "#558C8C")+
geom_ribbon(data = df_upperLower_2, alpha=0.2, aes(x=agemid, y=mean, ymin=lower, ymax=upper), fill = "#558C8C")+
geom_point(data = datS2, aes(x=agemid, y=midpoint), color = "#558C8C")+
geom_linerange(data = datS2, aes(x=agemid, ymin=lower, ymax=upper), color = "#558C8C")+
theme_bw()+
geom_line(data = df_upperLower_1, aes(x=agemid, y=mean),color = "#C05746")+
geom_ribbon(data = df_upperLower_1, alpha=0.2, aes(x=agemid, y=mean, ymin=lower, ymax=upper),fill = "#C05746")+
geom_point(data = datS1, aes(x=agemid, y=midpoint),color = "#C05746")+
geom_linerange(data = datS1, aes(x=agemid, ymin=lower, ymax=upper),color = "#C05746")
geom_line(data = df_upperLower_3, aes(x=agemid, y=mean),color = "#075E9D")+
geom_ribbon(data = df_upperLower_3, alpha=0.2, aes(x=agemid, y=mean, ymin=lower, ymax=upper),fill = "#075E9D")+
geom_point(data = datS3, aes(x=agemid, y=midpoint),color = "#075E9D")+
geom_linerange(data = datS3, aes(x=agemid, ymin=lower, ymax=upper),color = "#075E9D")
geom_line(data = df_upperLower_3, aes(x=agemid, y=mean),color = "#075E9D")+
geom_ribbon(data = df_upperLower_3, alpha=0.2, aes(x=agemid, y=mean, ymin=lower, ymax=upper),fill = "#075E9D")+
geom_point(data = datS3, aes(x=agemid, y=midpoint),color = "#075E9D")+
geom_linerange(data = datS3, aes(x=agemid, ymin=lower, ymax=upper),color = "#075E9D")
View(datS3)
geom_linerange(data = datS1, aes(x=agemid, ymin=lower, ymax=upper),color = "#C05746")
geom_line(data = df_upperLower_3, aes(x=agemid, y=mean),color = "#075E9D")
ggplot()+
geom_line(data = df_upperLower_2, aes(x=agemid, y=mean), color = "#558C8C")+
geom_ribbon(data = df_upperLower_2, alpha=0.2, aes(x=agemid, y=mean, ymin=lower, ymax=upper), fill = "#558C8C")+
geom_point(data = datS2, aes(x=agemid, y=midpoint), color = "#558C8C")+
geom_linerange(data = datS2, aes(x=agemid, ymin=lower, ymax=upper), color = "#558C8C")+
theme_bw()+
geom_line(data = df_upperLower_1, aes(x=agemid, y=mean),color = "#C05746")+
geom_ribbon(data = df_upperLower_1, alpha=0.2, aes(x=agemid, y=mean, ymin=lower, ymax=upper),fill = "#C05746")+
geom_point(data = datS1, aes(x=agemid, y=midpoint),color = "#C05746")+
geom_linerange(data = datS1, aes(x=agemid, ymin=lower, ymax=upper),color = "#C05746")
geom_line(data = df_upperLower_3, aes(x=agemid, y=mean),color = "#075E9D")+
geom_ribbon(data = df_upperLower_3, alpha=0.2, aes(x=agemid, y=mean, ymin=lower, ymax=upper),fill = "#075E9D")+
geom_point(data = datS3, aes(x=agemid, y=midpoint),color = "#075E9D")+
geom_linerange(data = datS3, aes(x=agemid, ymin=lower, ymax=upper),color = "#075E9D")
df_upperLower_3 = data.frame(
agemid = ager3,
mean = meanLambda3,
upper = quantileMatrix_3[,3],
lower = quantileMatrix_3[,2])
ggplot()+
geom_line(data = df_upperLower_2, aes(x=agemid, y=mean), color = "#558C8C")+
geom_ribbon(data = df_upperLower_2, alpha=0.2, aes(x=agemid, y=mean, ymin=lower, ymax=upper), fill = "#558C8C")+
geom_point(data = datS2, aes(x=agemid, y=midpoint), color = "#558C8C")+
geom_linerange(data = datS2, aes(x=agemid, ymin=lower, ymax=upper), color = "#558C8C")+
theme_bw()+
geom_line(data = df_upperLower_1, aes(x=agemid, y=mean),color = "#C05746")+
geom_ribbon(data = df_upperLower_1, alpha=0.2, aes(x=agemid, y=mean, ymin=lower, ymax=upper),fill = "#C05746")+
geom_point(data = datS1, aes(x=agemid, y=midpoint),color = "#C05746")+
geom_linerange(data = datS1, aes(x=agemid, ymin=lower, ymax=upper),color = "#C05746")
geom_line(data = df_upperLower_3, aes(x=agemid, y=mean),color = "#075E9D")+
geom_ribbon(data = df_upperLower_3, alpha=0.2, aes(x=agemid, y=mean, ymin=lower, ymax=upper),fill = "#075E9D")+
geom_point(data = datS3, aes(x=agemid, y=midpoint),color = "#075E9D")+
geom_linerange(data = datS3, aes(x=agemid, ymin=lower, ymax=upper),color = "#075E9D")
ggplot()+
geom_line(data = df_upperLower_2, aes(x=agemid, y=mean), color = "#558C8C")+
geom_ribbon(data = df_upperLower_2, alpha=0.2, aes(x=agemid, y=mean, ymin=lower, ymax=upper), fill = "#558C8C")+
geom_point(data = datS2, aes(x=agemid, y=midpoint), color = "#558C8C")+
geom_linerange(data = datS2, aes(x=agemid, ymin=lower, ymax=upper), color = "#558C8C")+
theme_bw()+
geom_line(data = df_upperLower_1, aes(x=agemid, y=mean),color = "#C05746")+
geom_ribbon(data = df_upperLower_1, alpha=0.2, aes(x=agemid, y=mean, ymin=lower, ymax=upper),fill = "#C05746")+
geom_point(data = datS1, aes(x=agemid, y=midpoint),color = "#C05746")+
geom_linerange(data = datS1, aes(x=agemid, ymin=lower, ymax=upper),color = "#C05746")+
geom_line(data = df_upperLower_3, aes(x=agemid, y=mean),color = "#075E9D")+
geom_ribbon(data = df_upperLower_3, alpha=0.2, aes(x=agemid, y=mean, ymin=lower, ymax=upper),fill = "#075E9D")+
geom_point(data = datS3, aes(x=agemid, y=midpoint),color = "#075E9D")+
geom_linerange(data = datS3, aes(x=agemid, ymin=lower, ymax=upper),color = "#075E9D")
ggplot()+
geom_line(data = df_upperLower_2, aes(x=agemid, y=mean), color = "#558C8C")+
geom_ribbon(data = df_upperLower_2, alpha=0.2, aes(x=agemid, y=mean, ymin=lower, ymax=upper), fill = "#558C8C")+
geom_point(data = datS2, aes(x=agemid, y=midpoint), color = "#558C8C")+
geom_linerange(data = datS2, aes(x=agemid, ymin=lower, ymax=upper), color = "#558C8C")+
geom_line(data = df_upperLower_1, aes(x=agemid, y=mean),color = "#C05746")+
geom_ribbon(data = df_upperLower_1, alpha=0.2, aes(x=agemid, y=mean, ymin=lower, ymax=upper),fill = "#C05746")+
geom_point(data = datS1, aes(x=agemid, y=midpoint),color = "#C05746")+
geom_linerange(data = datS1, aes(x=agemid, ymin=lower, ymax=upper),color = "#C05746")+
geom_line(data = df_upperLower_3, aes(x=agemid, y=mean),color = "#075E9D")+
geom_ribbon(data = df_upperLower_3, alpha=0.2, aes(x=agemid, y=mean, ymin=lower, ymax=upper),fill = "#075E9D")+
geom_point(data = datS3, aes(x=agemid, y=midpoint),color = "#075E9D")+
geom_linerange(data = datS3, aes(x=agemid, ymin=lower, ymax=upper),color = "#075E9D")+
theme_bw()+
scale_x_continuous(breaks = seq(0, 100, by = 10)) +
ylim(0, 1)
ggplot()+
geom_line(data = df_upperLower_2, aes(x=agemid, y=mean), color = "#558C8C")+
geom_ribbon(data = df_upperLower_2, alpha=0.2, aes(x=agemid, y=mean, ymin=lower, ymax=upper), fill = "#558C8C")+
geom_point(data = datS2, aes(x=agemid, y=midpoint), color = "#558C8C")+
geom_linerange(data = datS2, aes(x=agemid, ymin=lower, ymax=upper), color = "#558C8C")+
geom_line(data = df_upperLower_1, aes(x=agemid, y=mean),color = "#C05746")+
geom_ribbon(data = df_upperLower_1, alpha=0.2, aes(x=agemid, y=mean, ymin=lower, ymax=upper),fill = "#C05746")+
geom_point(data = datS1, aes(x=agemid, y=midpoint),color = "#C05746")+
geom_linerange(data = datS1, aes(x=agemid, ymin=lower, ymax=upper),color = "#C05746")+
geom_line(data = df_upperLower_3, aes(x=agemid, y=mean),color = "#075E9D")+
geom_ribbon(data = df_upperLower_3, alpha=0.2, aes(x=agemid, y=mean, ymin=lower, ymax=upper),fill = "#075E9D")+
geom_point(data = datS3, aes(x=agemid, y=midpoint),color = "#075E9D")+
geom_linerange(data = datS3, aes(x=agemid, ymin=lower, ymax=upper),color = "#075E9D")+
theme_bw()+
scale_x_continuous(breaks = seq(0, 100, by = 10)) +
ylim(0, 1)+
xlab("Age (years)") + ylab("Proportion Seropositive")
debugSource("C:/Users/Hyolim/OneDrive - London School of Hygiene and Tropical Medicine/CHIK/1.Aim1/codes/CHIK/democodes_chik.R")
debugSource("C:/Users/Hyolim/OneDrive - London School of Hygiene and Tropical Medicine/CHIK/1.Aim1/codes/CHIK/democodes_chik.R")
debugSource("C:/Users/Hyolim/OneDrive - London School of Hygiene and Tropical Medicine/CHIK/1.Aim1/codes/CHIK/democodes_chik.R")
